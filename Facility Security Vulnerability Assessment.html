<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facility Security Self-Assessment</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

        body {
            font-family: 'Roboto', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            color: #1e3a8a;
            border-bottom: 2px solid #3b82f6;
            padding-bottom: 10px;
        }
        .input-group {
            margin-bottom: 10px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input {
            width: 100%;
            padding: 5px;
            border-radius: 3px;
            border: 1px solid #ccc;
        }
        button {
            margin: 5px;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .options button {
            display: block;
            width: 100%;
            text-align: left;
            margin-bottom: 10px;
        }
        .recommendation, .background {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            background-color: #f0f9ff;
        }
        a {
            color: #3b82f6;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .option-button {
            background-color: #e2e8f0;
            color: black;
            display: block;
            width: 100%;
            text-align: left;
        }
        .option-button:hover {
            filter: brightness(0.9);
        }
        .option-button.selected {
            color: white;
        }
    </style>
</head>
<body>
    <h1>Facility Security Vulnerability Assessment</h1>
    
    <button onclick="clearAllData()">Clear all Data</button>
    <button onclick="clearResponses()">Clear all Security/Emergency Management Responses</button>

    <div class="input-group">
        <label for="facilityName">Facility Name:</label>
        <input type="text" id="facilityName">
    </div>
    <div class="input-group">
        <label for="reportDate">Date of Report:</label>
        <input type="date" id="reportDate">
    </div>
    <div class="input-group">
        <label for="reportNumber">Report Number:</label>
        <input type="text" id="reportNumber">
    </div>

    <h3>Security Management and Planning</h3>
    <div id="questions"></div>
    
    <h3>Personnel Security</h3>
    <div id="personnel-questions"></div>

    <h3>Security Force</h3>
    <div id="security-force-questions"></div>

    <h3>Perimeter and Access Control</h3>
    <div id="perimeter-questions"></div>

    <h3>Parking and Barriers</h3>
    <div id="parking-questions"></div>

    <h3>Access Control and Intrusion Detection</h3>
    <div id="access-control-questions"></div>

    <h3>Video Surveillance</h3>
    <div id="video-surveillance-questions"></div>

    <button onclick="downloadHtml()">Download HTML</button>
    <button onclick="generatePDF()">Generate PDF</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script>
        const questions = [
            "Does the facility have a designated security manager or security committee?",
            "Does the facility have a comprehensive written security and emergency operations plan?",
            "Are employees and volunteers trained on the security and emergency operations plan?",
            "Are visitors or clients informed about relevant elements of the security and emergency operations plan?",
            "Has the facility coordinated its security and emergency operations plan with local first responders?",
            "Does the facility conduct regular exercises of the security and emergency operations plan?",
            "Does the facility have lockdown, lockout, and shelter-in-place procedures?",
            "Does the facility have mass notification capabilities?",
            "Does the facility have crisis communications plans and procedures?",
            "Does the facility receive threat information or security-related bulletins from external sources?",
            "Does the facility participate in any external security or emergency preparedness working groups?"
        ];

        const personnelQuestions = [
            "Does the facility conduct background checks on employees and volunteers?",
            "Does the facility provide regular security awareness information to employees, volunteers, and clients?",
            "Does the facility have procedures for handling bomb threats and suspicious items?",
            "Does the facility have cash management controls?"
        ];

        const securityForceQuestions = [
            "Does the facility have a security force or security team for daily operations?",
            "What security training does the facility provide to security personnel, employees, or volunteers who fulfill security roles?",
            "Does the security team conduct security-related inspections or screening before people gather?",
            "Does the security team have appropriate communications equipment or panic alarms?",
            "Does the facility assign personnel to provide security presence during times of high vulnerability?",
            "Does the security team have designated posts/patrols and written post orders?",
            "Are frontline staff (e.g., receptionists, customer service) trained in security awareness and threat detection?",
            "Are there mechanisms for reporting concerning behaviors to security or management?"
        ];

        const perimeterQuestions = [
            "Does the facility have a well-established perimeter using natural materials or fencing/walls?",
            "Does the facility layout provide natural surveillance from the building to the outer perimeter?",
            "Are public and private spaces clearly separated?",
            "If the facility has a fence or wall, what is its primary purpose?",
            "Does the facility have controlled entry gates?",
            "Is the perimeter adequately illuminated?"
        ];

        const parkingQuestions = [
            "Are vehicles parked at the facility monitored?",
            "Does the facility have a policy to address vehicles parked for an extended period?",
            "Does the facility control vehicular parking and circulation onsite?",
            "Does the facility have high-speed vehicle approach routes?",
            "What is the minimum standoff distance between the facility and parked vehicles?",
            "Are parking areas adequately illuminated?"
        ];

        const accessControlQuestions = [
            "Does the facility screen persons, bags, or packages at entry points?",
            "Are facility doors closed and locked to prevent unauthorized access during operations?",
            "Can facility doors be easily secured in an emergency?",
            "Do exterior double doors have handles that can be tied together, potentially hindering evacuation?",
            "Does the facility have a key control program or defined process for access card management?",
            "Do exterior doors and windows have sufficient physical security to deter or delay an attack?",
            "Does the facility have an intrusion detection system (IDS) or alarm system?",
            "Does the interior layout provide multiple escape routes for emergency egress?"
        ];

        const videoSurveillanceQuestions = [
            "Does the facility have a camera system?",
            "Does the system use an effective combination of camera types (e.g., fixed, pan-tilt-zoom)?",
            "Is the camera system monitored during operational hours?",
            "Is camera footage recorded and reviewed regularly?",
            "What is the overall condition and capabilities of the camera system?"
        ];

        const optionsTemplate = [
            { label: 'Very Low', color: '#ef4444' },
            { label: 'Low', color: '#f97316' },
            { label: 'Medium', color: '#eab308' },
            { label: 'High', color: '#22c55e' },
            { label: 'Very High', color: '#3b82f6' }
        ];

        const specificQuestions = {
            "Does the facility have a designated security manager or security committee?": [
                "The facility does not have a security manager or committee.",
                "The facility has a security manager or committee, but security management activities are sporadic.",
                "The facility has a security manager or committee. Security management activities are regularly scheduled, but not coordinated with other departments.",
                "The facility has a security manager or committee. Activities are regularly scheduled and coordinated, but additional personnel are needed.",
                "The facility has a security manager or committee. Activities are fully coordinated and staffing levels fully support the security mission."
            ],
            "Does the facility have a comprehensive written security and emergency operations plan?": [
                "The facility does not have a comprehensive written security and emergency operations plan.",
                "The facility has a plan, but it is incomplete or outdated.",
                "The facility has a comprehensive plan, but it is not regularly reviewed or updated.",
                "The facility has a comprehensive plan that is regularly reviewed, but not all staff are familiar with it.",
                "The facility has a comprehensive plan that is regularly reviewed and all staff are familiar with it."
            ],
            "Are employees and volunteers trained on the security and emergency operations plan?": [
                "Employees and volunteers have not received training on the security and emergency operations plan.",
                "Some employees and volunteers have received training, but it is not consistent.",
                "Most employees and volunteers have received basic training, but advanced training is lacking.",
                "All employees and volunteers have received comprehensive training, but it is not regularly updated.",
                "All employees and volunteers have received comprehensive and regularly updated training."
            ],
            "Are visitors or clients informed about relevant elements of the security and emergency operations plan?": [
                "Visitors or clients are not informed about the security and emergency operations plan.",
                "Some visitors or clients are informed, but there is no consistent process.",
                "Most visitors or clients are informed, but the information is not comprehensive.",
                "All visitors or clients are informed, but the information is not regularly updated.",
                "All visitors or clients are comprehensively informed and the information is regularly updated."
            ],
            "Has the facility coordinated its security and emergency operations plan with local first responders?": [
                "The facility has not coordinated its plan with local first responders.",
                "There has been some coordination, but it is sporadic.",
                "There is regular coordination, but it is not comprehensive.",
                "There is comprehensive coordination, but it is not regularly updated.",
                "There is comprehensive and regularly updated coordination with local first responders."
            ],
            "Does the facility conduct regular exercises of the security and emergency operations plan?": [
                "The facility does not conduct regular exercises of the plan.",
                "Exercises are conducted sporadically and are not comprehensive.",
                "Regular exercises are conducted, but not all aspects of the plan are covered.",
                "Comprehensive exercises are conducted, but not regularly.",
                "Comprehensive and regular exercises are conducted covering all aspects of the plan."
            ],
            "Does the facility have lockdown, lockout, and shelter-in-place procedures?": [
                "The facility does not have lockdown, lockout, or shelter-in-place procedures.",
                "Some procedures exist, but they are incomplete or outdated.",
                "There are comprehensive procedures, but not all staff are familiar with them.",
                "There are comprehensive procedures and most staff are familiar with them.",
                "There are comprehensive and regularly updated procedures that all staff are familiar with."
            ],
            "Does the facility have mass notification capabilities?": [
                "The facility does not have mass notification capabilities.",
                "Some mass notification capabilities exist, but they are limited.",
                "There are mass notification capabilities, but they are not regularly tested.",
                "There are mass notification capabilities that are regularly tested, but not all staff are familiar with them.",
                "There are comprehensive mass notification capabilities that are regularly tested and all staff are familiar with them."
            ],
            "Does the facility have crisis communications plans and procedures?": [
                "The facility does not have crisis communications plans or procedures.",
                "Some plans and procedures exist, but they are incomplete or outdated.",
                "There are comprehensive plans and procedures, but not all staff are familiar with them.",
                "There are comprehensive plans and procedures and most staff are familiar with them.",
                "There are comprehensive and regularly updated plans and procedures that all staff are familiar with."
            ],
            "Does the facility receive threat information or security-related bulletins from external sources?": [
                "The facility does not receive threat information or security-related bulletins from external sources.",
                "Some information is received, but it is sporadic and not comprehensive.",
                "Regular information is received, but it is not always timely or relevant.",
                "Comprehensive information is received, but it is not regularly updated.",
                "Comprehensive and regularly updated information is received from reliable external sources."
            ],
            "Does the facility participate in any external security or emergency preparedness working groups?": [
                "The facility does not participate in any external security or emergency preparedness working groups.",
                "There is some participation, but it is sporadic and not comprehensive.",
                "Regular participation exists, but it is not always relevant.",
                "Comprehensive participation exists, but it is not regularly updated.",
                "Comprehensive and regularly updated participation in relevant working groups."
            ],
            "Does the facility conduct background checks on employees and volunteers?": [
                "The facility does not conduct background checks on employees or volunteers.",
                "Background checks are conducted inconsistently and only for certain positions.",
                "Regular background checks are conducted for most employees and volunteers, but not all.",
                "Comprehensive background checks are conducted for all employees and volunteers, but there are some delays.",
                "Comprehensive and timely background checks are conducted for all employees and volunteers."
            ],
            "Does the facility provide regular security awareness information to employees, volunteers, and clients?": [
                "The facility does not provide regular security awareness information.",
                "Security awareness information is provided sporadically and is not comprehensive.",
                "Regular security awareness information is provided, but it is not comprehensive or updated.",
                "Comprehensive security awareness information is provided regularly, but it is not always updated.",
                "Comprehensive and regularly updated security awareness information is provided to all employees, volunteers, and clients."
            ],
            "Does the facility have procedures for handling bomb threats and suspicious items?": [
                "The facility does not have procedures for handling bomb threats or suspicious items.",
                "Some procedures exist, but they are incomplete or outdated.",
                "There are comprehensive procedures, but not all staff are familiar with them.",
                "There are comprehensive procedures and most staff are familiar with them.",
                "There are comprehensive and regularly updated procedures that all staff are familiar with."
            ],
            "Does the facility have cash management controls?": [
                "The facility does not have cash management controls.",
                "Some cash management controls exist, but they are not comprehensive.",
                "Regular cash management controls are in place, but they are not always followed.",
                "Comprehensive cash management controls are in place, but they are not regularly updated.",
                "Comprehensive and regularly updated cash management controls are in place and followed by all staff."
            ],
            "Does the facility have a security force or security team for daily operations?": [
                "The facility does not have a security force or team for daily operations.",
                "The facility has a small security force or team, but their presence is sporadic.",
                "The facility has a dedicated security team, but they are understaffed for daily operations.",
                "The facility has a well-staffed security force for daily operations, but there are some coverage gaps.",
                "The facility has a fully staffed security force or team for comprehensive daily operations."
            ],
            "What security training does the facility provide to security personnel, employees, or volunteers who fulfill security roles?": [
                "The facility does not provide security training.",
                "Basic security training is provided, but it is not comprehensive.",
                "Regular security training is provided, but it lacks advanced components.",
                "Comprehensive security training is provided regularly, but updates are infrequent.",
                "Comprehensive and regularly updated security training is provided to all relevant personnel."
            ],
            "Does the security team conduct security-related inspections or screening before people gather?": [
                "The security team does not conduct inspections or screening.",
                "Inspections or screening are conducted sporadically and are not comprehensive.",
                "Regular inspections or screening are conducted, but they are not thorough.",
                "Comprehensive inspections or screening are conducted, but not consistently.",
                "Comprehensive and consistent inspections or screening are conducted before people gather."
            ],
            "Does the security team have appropriate communications equipment or panic alarms?": [
                "The security team does not have appropriate communications equipment or panic alarms.",
                "Some communications equipment or panic alarms are available, but they are insufficient.",
                "Communications equipment or panic alarms are available, but maintenance is lacking.",
                "Appropriate communications equipment or panic alarms are available, but not all staff are trained on their use.",
                "The security team has fully functional and regularly maintained communications equipment and panic alarms, with all staff trained on their use."
            ],
            "Does the facility assign personnel to provide security presence during times of high vulnerability?": [
                "The facility does not assign personnel for security presence during high vulnerability times.",
                "Personnel are assigned sporadically, but not consistently.",
                "Regular assignments are made, but there are coverage gaps.",
                "Comprehensive assignments are made for high vulnerability times, but some personnel are not adequately trained.",
                "Comprehensive and fully trained personnel are assigned to provide security presence during all times of high vulnerability."
            ],
            "Does the security team have designated posts/patrols and written post orders?": [
                "The security team does not have designated posts/patrols or written post orders.",
                "Some posts/patrols and orders exist, but they are not comprehensive.",
                "Regular posts/patrols and orders exist, but they are not always followed.",
                "Comprehensive posts/patrols and written orders exist, but they are not regularly updated.",
                "Comprehensive and regularly updated posts/patrols and written orders are in place and followed by all security personnel."
            ],
            "Are frontline staff (e.g., receptionists, customer service) trained in security awareness and threat detection?": [
                "Frontline staff are not trained in security awareness or threat detection.",
                "Some training is provided, but it is not comprehensive.",
                "Regular training is provided, but it lacks advanced components.",
                "Comprehensive training is provided regularly, but updates are infrequent.",
                "Comprehensive and regularly updated training is provided to all frontline staff in security awareness and threat detection."
            ],
            "Are there mechanisms for reporting concerning behaviors to security or management?": [
                "There are no mechanisms for reporting concerning behaviors.",
                "Some mechanisms exist, but they are not well-known or used.",
                "Regular mechanisms exist, but reporting is not always followed up.",
                "Comprehensive mechanisms exist, but they are not regularly updated.",
                "Comprehensive and regularly updated mechanisms for reporting concerning behaviors are in place and actively used."
            ],
            "Does the facility have a well-established perimeter using natural materials or fencing/walls?": [
                "The facility has no established perimeter.",
                "The facility has a partially established perimeter, but it is incomplete or inadequate.",
                "The facility has an established perimeter, but it is not well-maintained.",
                "The facility has a well-established and maintained perimeter.",
                "The facility has a well-established perimeter using natural materials or fencing/walls that are regularly maintained and inspected."
            ],
            "Does the facility layout provide natural surveillance from the building to the outer perimeter?": [
                "There is no natural surveillance from the building to the outer perimeter.",
                "Natural surveillance is limited and obstructed.",
                "There is partial natural surveillance with some obstructions.",
                "The facility layout provides good natural surveillance with minimal obstructions.",
                "The facility layout provides excellent natural surveillance with clear views from the building to the outer perimeter."
            ],
            "Are public and private spaces clearly separated?": [
                "There is no clear separation between public and private spaces.",
                "Separation is minimal and often unclear.",
                "There is some separation, but it is not consistently applied.",
                "Public and private spaces are clearly separated with minimal overlap.",
                "Public and private spaces are clearly and consistently separated with clear signage and barriers."
            ],
            "If the facility has a fence or wall, what is its primary purpose?": [
                "The facility has no fence or wall.",
                "The fence or wall is decorative with minimal security function.",
                "The fence or wall serves a moderate security purpose but has vulnerabilities.",
                "The fence or wall serves a significant security purpose with few vulnerabilities.",
                "The fence or wall serves a critical security purpose and is highly secure with no known vulnerabilities."
            ],
            "Does the facility have controlled entry gates?": [
                "The facility has no controlled entry gates.",
                "Entry gates are present but not consistently controlled.",
                "Entry gates are controlled, but there are occasional lapses in security.",
                "Entry gates are well-controlled with minimal security lapses.",
                "Entry gates are strictly controlled at all times with no security lapses."
            ],
            "Is the perimeter adequately illuminated?": [
                "The perimeter is not illuminated.",
                "Perimeter illumination is minimal and inadequate.",
                "Perimeter is partially illuminated but has dark spots.",
                "The perimeter is well-illuminated with minimal dark spots.",
                "The perimeter is fully illuminated with no dark spots."
            ],
            "Are vehicles parked at the facility monitored?": [
                "Vehicles parked at the facility are not monitored.",
                "Vehicles are sporadically monitored with no consistent process.",
                "Vehicles are regularly monitored, but there are gaps in coverage.",
                "Vehicles are monitored using a comprehensive system, but it is not regularly updated.",
                "Vehicles are continuously monitored using an advanced and regularly updated system."
            ],
            "Does the facility have a policy to address vehicles parked for an extended period?": [
                "The facility does not have a policy for vehicles parked for an extended period.",
                "The facility has an informal policy, but it is not consistently applied.",
                "The facility has a formal policy, but it is not comprehensive.",
                "The facility has a comprehensive policy, but it is not regularly reviewed.",
                "The facility has a comprehensive and regularly reviewed policy addressing vehicles parked for an extended period."
            ],
            "Does the facility control vehicular parking and circulation onsite?": [
                "The facility does not control vehicular parking and circulation onsite.",
                "Parking and circulation are controlled sporadically with no formal process.",
                "There is a formal process for controlling parking and circulation, but it is not comprehensive.",
                "Parking and circulation are controlled comprehensively, but the process is not regularly updated.",
                "Parking and circulation are comprehensively controlled with a regularly updated process."
            ],
            "Does the facility have high-speed vehicle approach routes?": [
                "The facility has multiple high-speed vehicle approach routes with no barriers.",
                "There are some high-speed vehicle approach routes with minimal barriers.",
                "High-speed vehicle approach routes are partially controlled with some barriers.",
                "High-speed vehicle approach routes are mostly controlled with adequate barriers.",
                "High-speed vehicle approach routes are fully controlled with robust barriers."
            ],
            "What is the minimum standoff distance between the facility and parked vehicles?": [
                "There is no designated standoff distance between the facility and parked vehicles.",
                "The standoff distance is less than 10 feet.",
                "The standoff distance is between 10 and 20 feet.",
                "The standoff distance is between 20 and 30 feet.",
                "The standoff distance is more than 30 feet."
            ],
            "Are parking areas adequately illuminated?": [
                "Parking areas are not illuminated.",
                "Parking areas are poorly illuminated with minimal lighting.",
                "Parking areas are partially illuminated, but there are significant dark spots.",
                "Parking areas are well-illuminated with minimal dark spots.",
                "Parking areas are fully illuminated with no dark spots."
            ],
            "Does the facility screen persons, bags, or packages at entry points?": [
                "The facility does not screen persons, bags, or packages at entry points.",
                "Screening is conducted sporadically and is not comprehensive.",
                "Regular screening is conducted, but there are gaps in coverage.",
                "Comprehensive screening is conducted, but it is not consistently applied.",
                "Comprehensive and consistent screening is conducted at all entry points."
            ],
            "Are facility doors closed and locked to prevent unauthorized access during operations?": [
                "Facility doors are not consistently closed and locked during operations.",
                "Some doors are closed and locked, but not consistently.",
                "Most doors are closed and locked, but there are occasional lapses.",
                "All doors are closed and locked with minimal lapses.",
                "All doors are consistently closed and locked to prevent unauthorized access."
            ],
            "Can facility doors be easily secured in an emergency?": [
                "Facility doors cannot be easily secured in an emergency.",
                "Some doors can be secured, but the process is not streamlined.",
                "Most doors can be secured, but there are delays.",
                "All doors can be secured quickly with minimal delays.",
                "All doors can be easily and quickly secured in an emergency."
            ],
            "Do exterior double doors have handles that can be tied together, potentially hindering evacuation?": [
                "All exterior double doors have handles that can be tied together.",
                "Most exterior double doors have handles that can be tied together.",
                "Some exterior double doors have handles that can be tied together.",
                "Few exterior double doors have handles that can be tied together.",
                "No exterior double doors have handles that can be tied together."
            ],
            "Does the facility have a key control program or defined process for access card management?": [
                "The facility does not have a key control program or defined process for access card management.",
                "A program or process exists, but it is not comprehensive.",
                "There is a comprehensive program or process, but it is not consistently applied.",
                "A comprehensive program or process is consistently applied, but it is not regularly updated.",
                "A comprehensive and regularly updated key control program or process is consistently applied."
            ],
            "Do exterior doors and windows have sufficient physical security to deter or delay an attack?": [
                "Exterior doors and windows do not have sufficient physical security.",
                "Some doors and windows have physical security measures, but they are not comprehensive.",
                "Most doors and windows have physical security measures, but there are gaps.",
                "All doors and windows have sufficient physical security with minimal gaps.",
                "All doors and windows have robust physical security measures to deter or delay an attack."
            ],
            "Does the facility have an intrusion detection system (IDS) or alarm system?": [
                "The facility does not have an intrusion detection system or alarm system.",
                "Some areas have an IDS or alarm system, but it is not comprehensive.",
                "Most areas have an IDS or alarm system, but there are gaps.",
                "All areas have an IDS or alarm system with minimal gaps.",
                "All areas have a comprehensive and fully functional IDS or alarm system."
            ],
            "Does the interior layout provide multiple escape routes for emergency egress?": [
                "The interior layout does not provide multiple escape routes.",
                "Some areas have multiple escape routes, but not all.",
                "Most areas have multiple escape routes, but there are obstacles.",
                "All areas have multiple escape routes with minimal obstacles.",
                "All areas have clearly marked and unobstructed multiple escape routes."
            ],
            "Does the facility have a camera system?": [
                "The facility does not have a camera system.",
                "The facility has a camera system, but it is outdated and needs improvement.",
                "The facility has a camera system that covers key areas, but it has gaps.",
                "The facility has a modern camera system that covers most areas, with some gaps.",
                "The facility has a state-of-the-art camera system that covers all critical areas comprehensively."
            ],
            "Does the system use an effective combination of camera types (e.g., fixed, pan-tilt-zoom)?": [
                "The facility does not use a combination of camera types.",
                "The facility uses a combination of camera types, but it is not effective.",
                "The facility uses a combination of camera types that is somewhat effective.",
                "The facility uses an effective combination of camera types, with some areas for improvement.",
                "The facility uses a highly effective combination of camera types that provides comprehensive coverage."
            ],
            "Is the camera system monitored during operational hours?": [
                "The camera system is not monitored during operational hours.",
                "The camera system is monitored sporadically during operational hours.",
                "The camera system is regularly monitored, but not consistently during all operational hours.",
                "The camera system is consistently monitored during most operational hours.",
                "The camera system is monitored at all times during operational hours."
            ],
            "Is camera footage recorded and reviewed regularly?": [
                "Camera footage is not recorded or reviewed.",
                "Camera footage is recorded, but rarely reviewed.",
                "Camera footage is recorded and reviewed occasionally.",
                "Camera footage is regularly recorded and reviewed, but not comprehensively.",
                "Camera footage is comprehensively recorded and regularly reviewed."
            ],
            "What is the overall condition and capabilities of the camera system?": [
                "The camera system is in poor condition and needs significant upgrades.",
                "The camera system is in fair condition, with some outdated components.",
                "The camera system is in good condition, with a few areas needing improvement.",
                "The camera system is in very good condition, with minor areas for improvement.",
                "The camera system is in excellent condition, with state-of-the-art capabilities."
            ]
        };

        const securityLevels = {
            'Very Low': {
                recommendation: 'Immediate action required: Establish a dedicated security management function. Designate a qualified individual as the security manager or form a security committee comprising key stakeholders. Develop a comprehensive security policy and implement basic security measures to address critical vulnerabilities. Conduct a thorough risk assessment to identify and prioritize security gaps. Establish relationships with local law enforcement and emergency services.',
                background: 'At this level, the facility is at high risk due to the lack of a structured approach to security management. The absence of a designated security manager or committee leaves the organization without clear leadership in security matters. This situation leaves the facility highly vulnerable to various threats and unprepared for emergencies or crisis situations.',
                references: [
                    { title: 'CISA: Security Management', url: 'https://www.cisa.gov/security-management' },
                    { title: 'ASIS International: Security Management', url: 'https://www.asisonline.org/publications--resources/security-topics/security-management/' }
                ]
            },
            'Low': {
                recommendation: 'Priority action needed: Enhance the existing security management structure. Provide advanced training for the security manager or committee members. Conduct a comprehensive risk assessment to identify and prioritize security gaps. Develop and implement a strategic security plan aligned with organizational goals. Implement a formal incident reporting and investigation process.',
                background: 'At this level, while there may be some basic security measures in place, they are likely insufficient and not well-coordinated. The sporadic nature of security activities indicates a reactive rather than proactive approach to security management. This leaves the facility vulnerable to a wide range of threats and unprepared for evolving security challenges.',
                references: [
                    { title: 'DHS Risk Management Fundamentals', url: 'https://www.dhs.gov/sites/default/files/publications/risk-management-fundamentals.pdf' },
                    { title: 'SANS Institute: Physical Security', url: 'https://www.sans.org/security-awareness-training/resources/physical-security' }
                ]
            },
            'Medium': {
                recommendation: 'Continued improvement required: Optimize the security management process. Integrate security considerations into all aspects of facility operations. Implement a continuous improvement cycle for security measures. Enhance coordination with external security partners and local law enforcement. Develop a comprehensive security awareness program for all employees.',
                background: 'At this level, the facility has established basic security management practices. However, there\'s significant room for improvement in terms of integration, continuous assessment, and external partnerships. While security activities are regularly scheduled, the lack of coordination with other departments indicates potential silos in the organization\'s approach to security.',
                references: [
                    { title: 'CISA: Physical Security Measures', url: 'https://www.cisa.gov/physical-security' },
                    { title: 'Security Industry Association (SIA): Physical Security', url: 'https://www.securityindustry.org/industry-standards/physical-security/' }
                ]
            },
            'High': {
                recommendation: 'Maintain and enhance: Sustain the robust security management structure. Implement advanced security technologies and methodologies. Conduct regular third-party security audits. Develop and maintain a culture of security awareness among all staff and stakeholders. Consider establishing a 24/7 security operations center (SOC) if not already in place.',
                background: 'At this level, the facility has a well-established security management system. There\'s a dedicated security team, regular risk assessments, and a comprehensive security strategy. The focus is on maintaining this high standard and looking for areas of further improvement. However, the need for additional personnel suggests that the security function may be stretched thin.',
                references: [
                    { title: 'CISA: Cybersecurity', url: 'https://www.cisa.gov/cybersecurity' },
                    { title: 'NIST: Cybersecurity Framework', url: 'https://www.nist.gov/cyberframework' }
                ]
            },
            'Very High': {
                recommendation: 'Industry-leading practices: Maintain exemplary security management standards. Share best practices with industry peers. Participate in developing industry security standards. Implement cutting-edge security technologies and predictive threat analysis capabilities. Establish a dedicated research and development team focused on emerging security technologies and methodologies.',
                background: 'At this level, the facility is at the forefront of security management. It has a comprehensive, integrated approach to security that\'s regularly reviewed and updated. The security team is highly trained, well-resourced, and proactive, often leading in the development of new security practices. However, maintaining this high level of security requires significant ongoing investment in personnel, technology, and processes.',
                references: [
                    { title: 'ASIS International: Protection of Assets (POA)', url: 'https://www.asisonline.org/publications--resources/protection-of-assets/' },
                    { title: 'CISA: Security of Soft Targets and Crowded Placesâ€“Resource Guide', url: 'https://www.cisa.gov/sites/default/files/publications/19_0424_cisa_soft-targets-and-crowded-places-resource-guide.pdf' }
                ]
            }
        };

        let selectedOption = {};
        let showBackground = {};

        function renderQuestions() {
            const questionsDiv = document.getElementById('questions');
            questionsDiv.innerHTML = questions.map((question, index) => 
                `<div class="question-group">
                    <h4>${question}</h4>
                    ${optionsTemplate.map((option, optionIndex) => 
                        `<button class="option-button" id="option-main-${index}-${optionIndex}" style="background-color: #e2e8f0;"
                            onclick="selectOption('main', ${index}, ${optionIndex})">
                            <strong>${option.label}</strong>: ${specificQuestions[question][optionIndex]}
                        </button>`
                    ).join('')}
                    <div id="recommendation-main-${index}" class="recommendation" style="display: none;"></div>
                    <button id="toggleBackground-main-${index}" onclick="toggleBackground('main', ${index})" style="display: none;">Show Background Information</button>
                    <div id="background-main-${index}" class="background" style="display: none;"></div>
                </div>`
            ).join('');

            const personnelQuestionsDiv = document.getElementById('personnel-questions');
            personnelQuestionsDiv.innerHTML = personnelQuestions.map((question, index) => 
                `<div class="question-group">
                    <h4>${question}</h4>
                    ${optionsTemplate.map((option, optionIndex) => 
                        `<button class="option-button" id="option-personnel-${index}-${optionIndex}" style="background-color: #e2e8f0;"
                            onclick="selectOption('personnel', ${index}, ${optionIndex})">
                            <strong>${option.label}</strong>: ${specificQuestions[question][optionIndex]}
                        </button>`
                    ).join('')}
                    <div id="recommendation-personnel-${index}" class="recommendation" style="display: none;"></div>
                    <button id="toggleBackground-personnel-${index}" onclick="toggleBackground('personnel', ${index})" style="display: none;">Show Background Information</button>
                    <div id="background-personnel-${index}" class="background" style="display: none;"></div>
                </div>`
            ).join('');

            const securityForceQuestionsDiv = document.getElementById('security-force-questions');
            securityForceQuestionsDiv.innerHTML = securityForceQuestions.map((question, index) => 
                `<div class="question-group">
                    <h4>${question}</h4>
                    ${optionsTemplate.map((option, optionIndex) => 
                        `<button class="option-button" id="option-security-force-${index}-${optionIndex}" style="background-color: #e2e8f0;"
                            onclick="selectOption('security-force', ${index}, ${optionIndex})">
                            <strong>${option.label}</strong>: ${specificQuestions[question][optionIndex]}
                        </button>`
                    ).join('')}
                    <div id="recommendation-security-force-${index}" class="recommendation" style="display: none;"></div>
                    <button id="toggleBackground-security-force-${index}" onclick="toggleBackground('security-force', ${index})" style="display: none;">Show Background Information</button>
                    <div id="background-security-force-${index}" class="background" style="display: none;"></div>
                </div>`
            ).join('');

            const perimeterQuestionsDiv = document.getElementById('perimeter-questions');
            perimeterQuestionsDiv.innerHTML = perimeterQuestions.map((question, index) => 
                `<div class="question-group">
                    <h4>${question}</h4>
                    ${optionsTemplate.map((option, optionIndex) => 
                        `<button class="option-button" id="option-perimeter-${index}-${optionIndex}" style="background-color: #e2e8f0;"
                            onclick="selectOption('perimeter', ${index}, ${optionIndex})">
                            <strong>${option.label}</strong>: ${specificQuestions[question][optionIndex]}
                        </button>`
                    ).join('')}
                    <div id="recommendation-perimeter-${index}" class="recommendation" style="display: none;"></div>
                    <button id="toggleBackground-perimeter-${index}" onclick="toggleBackground('perimeter', ${index})" style="display: none;">Show Background Information</button>
                    <div id="background-perimeter-${index}" class="background" style="display: none;"></div>
                </div>`
            ).join('');

            const parkingQuestionsDiv = document.getElementById('parking-questions');
            parkingQuestionsDiv.innerHTML = parkingQuestions.map((question, index) => 
                `<div class="question-group">
                    <h4>${question}</h4>
                    ${optionsTemplate.map((option, optionIndex) => 
                        `<button class="option-button" id="option-parking-${index}-${optionIndex}" style="background-color: #e2e8f0;"
                            onclick="selectOption('parking', ${index}, ${optionIndex})">
                            <strong>${option.label}</strong>: ${specificQuestions[question][optionIndex]}
                        </button>`
                    ).join('')}
                    <div id="recommendation-parking-${index}" class="recommendation" style="display: none;"></div>
                    <button id="toggleBackground-parking-${index}" onclick="toggleBackground('parking', ${index})" style="display: none;">Show Background Information</button>
                    <div id="background-parking-${index}" class="background" style="display: none;"></div>
                </div>`
            ).join('');

            const accessControlQuestionsDiv = document.getElementById('access-control-questions');
            accessControlQuestionsDiv.innerHTML = accessControlQuestions.map((question, index) => 
                `<div class="question-group">
                    <h4>${question}</h4>
                    ${optionsTemplate.map((option, optionIndex) => 
                        `<button class="option-button" id="option-access-control-${index}-${optionIndex}" style="background-color: #e2e8f0;"
                            onclick="selectOption('access-control', ${index}, ${optionIndex})">
                            <strong>${option.label}</strong>: ${specificQuestions[question][optionIndex]}
                        </button>`
                    ).join('')}
                    <div id="recommendation-access-control-${index}" class="recommendation" style="display: none;"></div>
                    <button id="toggleBackground-access-control-${index}" onclick="toggleBackground('access-control', ${index})" style="display: none;">Show Background Information</button>
                    <div id="background-access-control-${index}" class="background" style="display: none;"></div>
                </div>`
            ).join('');

            const videoSurveillanceQuestionsDiv = document.getElementById('video-surveillance-questions');
            videoSurveillanceQuestionsDiv.innerHTML = videoSurveillanceQuestions.map((question, index) => 
                `<div class="question-group">
                    <h4>${question}</h4>
                    ${optionsTemplate.map((option, optionIndex) => 
                        `<button class="option-button" id="option-video-surveillance-${index}-${optionIndex}" style="background-color: #e2e8f0;"
                            onclick="selectOption('video-surveillance', ${index}, ${optionIndex})">
                            <strong>${option.label}</strong>: ${specificQuestions[question][optionIndex]}
                        </button>`
                    ).join('')}
                    <div id="recommendation-video-surveillance-${index}" class="recommendation" style="display: none;"></div>
                    <button id="toggleBackground-video-surveillance-${index}" onclick="toggleBackground('video-surveillance', ${index})" style="display: none;">Show Background Information</button>
                    <div id="background-video-surveillance-${index}" class="background" style="display: none;"></div>
                </div>`
            ).join('');
        }

        function selectOption(section, questionIndex, optionIndex) {
            const option = optionsTemplate[optionIndex];
            selectedOption[`${section}-${questionIndex}`] = option.label;

            // Clear previous selections
            const buttons = document.querySelectorAll(`#${section}-questions .question-group:nth-child(${questionIndex + 1}) .option-button`);
            buttons.forEach(button => {
                button.classList.remove('selected');
                button.style.backgroundColor = '#e2e8f0';
                button.style.color = 'black';
            });

            const selectedButton = document.getElementById(`option-${section}-${questionIndex}-${optionIndex}`);
            selectedButton.classList.add('selected');
            updateUI(section, questionIndex, option.color);
        }

        function toggleBackground(section, questionIndex) {
            showBackground[`${section}-${questionIndex}`] = !showBackground[`${section}-${questionIndex}`];
            updateUI(section, questionIndex);
        }

        function updateUI(section, questionIndex, color) {
            const recommendationDiv = document.getElementById(`recommendation-${section}-${questionIndex}`);
            const backgroundDiv = document.getElementById(`background-${section}-${questionIndex}`);
            const toggleButton = document.getElementById(`toggleBackground-${section}-${questionIndex}`);
            const buttons = document.querySelectorAll(`#${section}-questions .question-group:nth-child(${questionIndex + 1}) .option-button`);

            buttons.forEach(button => {
                button.style.backgroundColor = '#e2e8f0';
                button.style.color = 'black';
            });

            const selectedButton = document.querySelector(`#${section}-questions .question-group:nth-child(${questionIndex + 1}) .option-button.selected`);
            if (selectedButton) {
                selectedButton.style.backgroundColor = color;
                selectedButton.style.color = 'white';
            }

            if (selectedOption[`${section}-${questionIndex}`] && securityLevels[selectedOption[`${section}-${questionIndex}`]]) {
                recommendationDiv.style.display = 'block';
                recommendationDiv.innerHTML = `<h4>Expert Recommendation:</h4><p>${securityLevels[selectedOption[`${section}-${questionIndex}`]].recommendation}</p>`;
                toggleButton.style.display = 'block';
                toggleButton.textContent = showBackground[`${section}-${questionIndex}`] ? 'Hide Background Information' : 'Show Background Information';

                if (showBackground[`${section}-${questionIndex}`]) {
                    backgroundDiv.style.display = 'block';
                    backgroundDiv.innerHTML = `
                        <h4>Background:</h4>
                        <p>${securityLevels[selectedOption[`${section}-${questionIndex}`]].background}</p>
                        <h4>References:</h4>
                        <ul>
                            ${securityLevels[selectedOption[`${section}-${questionIndex}`]].references.map(ref => `<li><a href="${ref.url}" target="_blank" rel="noopener noreferrer">${ref.title}</a></li>`).join('')}
                        </ul>
                    `;
                } else {
                    backgroundDiv.style.display = 'none';
                }
            } else {
                recommendationDiv.style.display = 'none';
                backgroundDiv.style.display = 'none';
                toggleButton.style.display = 'none';
            }
        }

        function clearAllData() {
            document.getElementById('facilityName').value = '';
            document.getElementById('reportDate').value = '';
            document.getElementById('reportNumber').value = '';
            selectedOption = {};
            showBackground = {};
            renderQuestions();
            alert('All data cleared!');
        }

        function clearResponses() {
            selectedOption = {};
            showBackground = {};
            renderQuestions();
            alert('All Security/Emergency Management Responses cleared!');
        }

        function downloadHtml() {
            const element = document.createElement('a');
            const file = new Blob([document.documentElement.outerHTML], { type: 'text/html' });
            element.href = URL.createObjectURL(file);
            element.download = 'security-dashboard.html';
            document.body.appendChild(element); // Required for this to work in FireFox
            element.click();
        }

        async function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            doc.text("Facility Security Self-Assessment", 10, 10);

            const facilityName = document.getElementById('facilityName').value;
            const reportDate = document.getElementById('reportDate').value;
            const reportNumber = document.getElementById('reportNumber').value;

            doc.text(`Facility Name: ${facilityName}`, 10, 20);
            doc.text(`Date of Report: ${reportDate}`, 10, 30);
            doc.text(`Report Number: ${reportNumber}`, 10, 40);

            let yOffset = 50;

            function addSection(title, questions, section) {
                doc.setFontSize(12);
                doc.text(title, 10, yOffset);
                yOffset += 10;

                questions.forEach((question, index) => {
                    const selected = selectedOption[`${section}-${index}`];
                    const color = selected ? optionsTemplate.find(option => option.label === selected).color : '#000000';

                    doc.setFontSize(10);
                    doc.setTextColor(color);
                    doc.text(question, 10, yOffset);
                    yOffset += 10;

                    if (selected) {
                        doc.setTextColor(0, 0, 0);
                        doc.text(`Selected: ${selected}`, 10, yOffset);
                        yOffset += 10;

                        const recommendation = securityLevels[selected]?.recommendation;
                        if (recommendation) {
                            doc.text(`Recommendation: ${recommendation}`, 10, yOffset);
                            yOffset += 20;
                        }

                        const background = securityLevels[selected]?.background;
                        if (background) {
                            doc.text(`Background: ${background}`, 10, yOffset);
                            yOffset += 20;
                        }

                        const references = securityLevels[selected]?.references;
                        if (references && references.length > 0) {
                            doc.text('References:', 10, yOffset);
                            yOffset += 10;
                            references.forEach(ref => {
                                doc.text(`${ref.title}: ${ref.url}`, 10, yOffset);
                                yOffset += 10;
                            });
                            yOffset += 10;
                        }
                    }
                });
            }

            addSection("Security Management and Planning", questions, 'main');
            addSection("Personnel Security", personnelQuestions, 'personnel');
            addSection("Security Force", securityForceQuestions, 'security-force');
            addSection("Perimeter and Access Control", perimeterQuestions, 'perimeter');
            addSection("Parking and Barriers", parkingQuestions, 'parking');
            addSection("Access Control and Intrusion Detection", accessControlQuestions, 'access-control');
            addSection("Video Surveillance", videoSurveillanceQuestions, 'video-surveillance');

            doc.save("Facility_Security_Self-Assessment.pdf");
        }

        renderQuestions();
    </script>
</body>
</html>
